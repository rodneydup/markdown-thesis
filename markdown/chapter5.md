# Interface

CHON was designed to allow the user to interact with the particle system as directly and intuitively as possible. The visual interface consists of the particle system itself, a graph readout of all the particle displacements, and a GUI (Graphic User Interface) for changing various parameters of the system. The auditory interface of CHON consists of various optional synthesis  algorithms. CHON accepts user input via mouse and keyboard.

## Visual interface

![\small The visual particle interface (bottom) and the displacement graph (above). \label{visualInterface}](figures/visualInterface.png)

CHON's visual interface is dominated by the particle simulation in the center of the screen. It is roughly skeuomorphic â€” the kind of particle system it simulates is mimicked in the visual representation on screen. The spheres on screen are analogous to the masses in a mass-spring system, and if you displace the system, it behaves as you would expect a real mass-spring system to behave. However, it is an idealized simulation without gravity and (optionally) without air resistance. The major difference between CHON and a real mass-spring system is that the springs are not illustrated in CHON. This was a conscious omission as it seemed that visual connections between the particles would clutter the visual display and would provide no useful information to the user. The boundaries or anchors at the edges of the system may be visualized or not at the user's discretion. They are represented by white, immobile particles. The particles where given different colors to differentiate them and to allow them to be mapped to the 2D displacement graph.

The displacement graph is located above the particle simulation on the screen. In the graph, there is a line for each particle that is mapped to the same color as the particle it represents. The graph shows the displacement of each particle from its equilibrium position in a particular axis. The user may choose which axis is graphed using the GUI described below. Each line on the graph moves up or down when its corresponding particle moves right or left (if x-axis is selected), up or down (if y-axis), or forward or back (if z-axis). Time is represented on the graph horizontally as a continuously scrolling timeline with the present values being added on the right, pushing older values to the left. The graph serves as an additional readout for the user that allows them to understand the dynamics of the system better. It also provides a way to visualize the displacement data that can be broadcast over OSC.

The view of the particle system is set to a sensible default, directly facing the string of particles so they are spread horizontally on the screen, with the y axis up and down relative to the camera, and the z axis forward and back. The user can change the view manually if desired using the arrow keys on their keyboard. This is necessary when the user wants to move the particles in the z axis or when they simply wish to view the system from another angle for example. The up arrow moves the camera up, the down arrow moves the camera down, and the left and right arrows rotate the camera around the particle system. The user can press the "v" key on their keyboard at any time to reset the view.

When particles are added in the y-axis, CHON enters grid mode. In grid mode, the camera defaults to a position and angle where the user can see the entire two-dimensional grid of particles and manipulate them easily.

![\small Grid mode \label{gridMode}](figures/gridMode.png)

## GUI

The GUI of CHON presents further options to control the program. It is divided in to four windows: *Display*, *Physics*, *Synthesis*, and *OSC*. The windows are arranged on the left side of the screen, and each one can be collapsed or expanded using the triangle in the top-left of the window. Pressing "g" on the keyboard shows/hides the GUI.

The GUI controls consist of sliders, checkboxes, number-boxes, and drop-down menus. Sliders are operated by either left-clicking and dragging, or holding control and clicking on the slider and typing the desired value. Checkboxes are boolean "on or off" boxes that are toggled by left-clicking on them. Number-boxes can accept a typed number or they can be incremented/decremented via the "+" and "-" buttons beside them. Drop-down menus reveal their options when they are left-clicked, and a choice can then be selected by left-clicking.

The Display window controls what is visible and some other aspects of visual display. The user can show or hide the graph, particles, and boundary particles, using the checkboxes in this window. The *Graph Axis* drop-down menu can be used to change which axis of movement of the particles is mapped to the graph. The *Spread* slider allows the user to separate the graph lines by spreading them out vertically. The *Speed* slider controls how fast the graph moves. At the bottom of the Display window there is also a readout showing the frame-rate of the program.

![\small The Display window (left) \label{displayWindow}](figures/display.png)

The Physics window allows the user to alter the physical properties of CHON. The Particle Count section controls how many particles are present in the system. There are two number-boxes, controlling the number of particles in X (left-right) and Y (up-down) directions of a 2D plane of particles, respectively. For example, if the the *x* number-box is set to 5, and the *y* number-box is set to 4, then the particles will be arranged in a 5 by 4 grid. By default, Y is set to 1, and the system is in "1D" mode. If the user sets Y to a value greater than 1, CHON automatically enters "2D" mode. CHON will re-enter 1D mode if the user sets Y back to 1. The maximum number of total particles in the system is limited to 100.

The *X Springs* section of the window provides control over spring stiffness in the X direction. If *Global* is selected, the *stiffness* slider controls the stiffness of all springs oriented in the X direction. If *Global* is unselected, then a number-box appears with increment/decrement buttons. The number in the number-box indicates a particular spring in the system, with "0" representing the spring between the left-most particle and the left boundary, and 1 is the spring between that particle and it's neighbor on the right, and so on. Moving the *Stiffness* slider with *Global* unselected changes the stiffness of only the selected spring. 

![\small The Physics window \label{physicsWindow}](figures/physics.png)

If CHON is in 2D mode, then the *Y Springs* section appears, allowing similar control over the springs in the Y direction. In the Y direction, springs are numbered from bottom to top. So, for example, if the stiffness of *X Spring* 0 and *Y Spring* 0 are increased to 50, then the bottom row of springs and the left-most column of springs will have a stiffness constant of 50.

The *Mass* slider controls the mass of all the particles. There is no way to change the mass of individual particles because that would be redundant (raising spring stiffness is equivalent to lowering mass). The *Damping* slider controls the global damping of the system. A damping value of 0 will allow CHON to continue oscillating indefinitely. There are three *Degrees of Freedom* checkboxes that allow the user to constrain the dimensions that the particles may move in. The *Pause* button allows the user to freeze CHON in place. When CHON is frozen, the positions and momenta of the particles are preserved, but the positions may be altered by the user by clicking and dragging particles. Deselecting *Pause* causes CHON to resume simulation.

The Synthesis window provides control over the internal sound engine of CHON. The sound engine is described in Chapter 4. The Bell Synth, Additive Synth, and Reverb, are hidden by default and can be turned on and off with their respective checkboxes. By default, all of these checkboxes are unselected, and the synthesis controls are hidden. Pressing the triangle on one of the headers will reveal the controls for the respective section. 

![\small The Synthesis window \label{synthesisWindow}](figures/synthesis.png)

The *Bell Synth* section contains the *Bell Synth On* checkbox, the **Axis* drop-down, the *Scale* drop-down, as well as the *Root* and *Volume* sliders. *Bell Synth On* toggles the bell synth on and off. The *Axis* drop-down menu controls whether the bell sound of each particle is triggered when it crosses it's x-axis, y-axis, or z-axis equilibrium point. The *Scale* drop-down provides a few options for tuning the particles to scales. The *Root* slider determines the frequency of the bell of the left-most particle (bottom-left if in 2D mode), and the frequency of the bells of the rest of the particles are determined relative to this root frequency according to the selected scale. The *Volume* slider determines the volume of the bell synth.

The *Additive Synth* section contains the *Additive Synth On* checkbox, the *Root* and *Volume* sliders, as well as the FM and AM subsections. The *Additive Synth On* checkbox toggles the Additive synth on and off. The *Root* slider, like the one in the bell synth section, determines the frequency of the sine oscillator of the left-most particle (bottom-left in 2D mode). The *Volume* slider controls the volume of the additive synth. There is no scale drop-down here like there is in the bell synth. The frequencies of the particles are tuned to harmonic overtones of the root frequency. By default, the particle system has no effect on the additive synth. The user must activate the FM and/or AM functionalities to tie the additive synth to the state of the particle system.

The *FM* subsection contains an on/off checkbox, an *Axis* drop-down, and *Frequency* and *Width* sliders. Selecting the *FM On* checkbox allows the oscillators of the additive synth to be frequency modulated by the displacement of particles. The *Axis* drop-down determines which displacement axis is mapped to the FM synth. As described in Chapter 4, the displacement of the particles controls the width of the modulating signal that is acting on that particle's carrier signal. The modulating signal's frequency is determined by the *Frequency* slider. The number in the frequency slider corresponds to a ratio relative to the carrier signals. If the *Frequency* is set to 1, then the modulating signal is the same frequency as the carrier signal. If it is 2, then the modulating frequency is double that of the carrier frequency. A setting of zero on this slider is a special case in which the carrier signal's frequency is modulated exactly by the displacement of the particle. The *Width* slider allows the user to amplify and attenuate the FM effect on the additive synth.

The *AM* subsection contains only an on/off checkbox and an *Axis* drop-down. If the *AM On* checkbox is selected, then the amplitude of each oscillator of the additive synth is modulated by the displacement in the *Axis* direction of its corresponding particle. With AM turned on, the additive synth will make no sound when all particles are resting at equilibrium.

The *Reverb* section allows the user to apply a global reverb to the sound engine. This section contains an on/off checkbox and the *Tail* slider. If the *Reverb On* checkbox is selected, then a reverb is applied to both the bell synth and the additive synth. The length of the decay of this reverb can be increased and decreased via the *Tail* slider. The user should be cautious. If the *Tail* slider is set to 1, it will produce an infinite reverb that can become quite loud.

The OSC window provides control over the OSC broadcasting functionality of CHON. It contains the *OSC On* checkbox, three checkboxes for controlling what data is broadcast, a text box for inputting the IP address of the OSC broadcast, and a number box to change the port to send the OSC data through. The OSC server is off by default and can be turned on with the *OSC On* checkbox. With OSC turned on, it still will not broadcast any data unless at least one of *X disp*, *Y disp*, or *Z disp* are selected. For example, if only *Y disp* is selected, then only the displacement of the particles in the Y direction will be broadcast, and if all three are selected, then the displacements in all three directions will be broadcast. The user can change the IP address by typing in the text box and pressing enter to confirm. The Port can be changed by typing in the *Port* number box and pressing enter, or by incrementing/decrementing the value with the "+" and "-" buttons. The OSC client will automatically reset when these values are updated.

![\small The OSC window \label{OSCWindow}](figures/osc.png)

## Interaction

The interface for CHON is centered around directly manipulating the particles with a mouse. The user can left-click and hold on any particle and drag the particle from it's equilibrium position. The whole system will react in real time to this action, as other particles that are coupled to the selected particle are pulled along as well. If the user releases the mouse button, then the particles will be freed and set into oscillatory motion. The user can click and hold on any particle while it is in motion to grab it. It is also possible to drive the system manually by moving the mouse back and forth while holding a particle.

This direct interaction with the particle system in CHON is vital to the mission of CHON to allow the user to directly experiment and play with the mass-spring simulation. Because of this design, the user can easily influence the system and get immediate feedback, encouraging an iterative feedback loop conducive to creative exploration. The user can set CHON into motion and it will produce a chain reaction on its own from there. However, the user can also intervene to interrupt a moving particle, break symmetry, and cause new ripples, waves, and explosions. CHON then provides visual and auditory feedback so that the user can learn and understand the effects of their actions.

Aside from using the mouse to interact with the particle system and the GUI, there are also a limited number of keyboard shortcuts. The "p" key toggles the *Pause* checkbox in the Physics window, allowing the user to pause and unpause the simulation without accessing the GUI. The "g" key toggles the GUI's visibility on and off. The "r" key adds a random value to the velocity all of the particles.

